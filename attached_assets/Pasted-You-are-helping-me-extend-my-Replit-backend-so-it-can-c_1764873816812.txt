You are helping me extend my Replit backend so it can create and update legal case records in my Supabase database. Follow the instructions exactly. Do NOT include any code comments or explanations unless explicitly requested. Output only the final file structure and the code implementing the instructions.

Project context

I have a Supabase project with a cases table.
The table has the following columns:

id (uuid, primary key, autogenerated in Supabase)

user_id (uuid, required)

title (text, required)

description (text, required)

client_role (text, required)

category (text, required)

claim_amount_eur (numeric)

client_name (text)

client_address (text)

client_city (text, required)

opponent_type (text, required)

opponent_company (text)

opponent_email (text)

opponent_phone (text)

opponent_address (text)

opponent_city (text)

status (text)

created_at (timestamptz, default now())

updated_at (timestamptz)

Row Level Security is enabled. Policies require that user_id = auth.uid().

Requirements
1. Environment variables

Use ONLY environment variables:

SUPABASE_URL

SUPABASE_ANON_KEY

Never hard-code keys or URLs.

2. Supabase Client

Create one reusable Supabase client that:

imports createClient from @supabase/supabase-js

reads both environment variables

throws an error if either variable is missing

This client must be imported by all route files.

3. Authentication middleware

Implement middleware that simulates authentication by injecting a fixed test user object:

req.user = { id: "<a static UUID for testing>" }


The middleware must be applied globally before the route handlers.
Later I will replace it with real authentication.

4. API routes for case management

Create an Express router under /api/cases that implements these endpoints:

a) POST /api/cases

Accepts all fields from the table except id, created_at, updated_at.

Validates required fields (title, description, client_role, category, client_city, opponent_type).

Automatically sets:

user_id = req.user.id

created_at = now()

updated_at = now()

Inserts the new record into Supabase.

Returns the inserted row or an error.

b) GET /api/cases

Queries all cases where user_id = req.user.id.

Returns the list or an error.

c) GET /api/cases/:id

Fetches a single case record where both id and user_id match.

If not found, return HTTP 404.

d) PUT /api/cases/:id

Accepts the same fields as POST (except the PK fields).

Automatically sets updated_at = now().

Updates the record only if id AND user_id match.

Returns the updated row or an error.

e) DELETE /api/cases/:id

Deletes the record only where both id and user_id match.

Returns { success: true } or an error.

5. Error handling

Each endpoint must:

check Supabase errors and return HTTP 500 with a JSON error message

return HTTP 404 when a record does not exist or does not belong to the user

never expose internal details or stack traces to the client

6. Output format

When you respond:

Provide the full file structure (e.g., /supabaseClient.js, /routes/cases.js, /index.js).

Provide complete code for all files required.

Do not include explanation text.

Keep everything minimal, clean, and consistent with Express best practices.

Now generate the complete final solution.